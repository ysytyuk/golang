package main

import (
	"fmt"
	"sort"
	"time"
)

func filterTime(timersData []int64) []int64 {

	// Sorted elements
	sort.Slice(timersData, func(i, j int) bool { return timersData[i] < timersData[j] })

	// Remove dublicate elements
	for i, x := range timersData {
		if i > 0 && timersData[i-1] == x {
			if i+1 < len(timersData) {
				timersData = append(timersData[:i], timersData[i+1:]...)
			} else {
				timersData = timersData[:i]
			}
		}

	}

	for _, p := range timersData {
		fmt.Println(time.Unix(p, 0))
	}

	fmt.Println()

	const timeDelta = 7200
	filteredList := []int64{}
	// Save biggest elements for compare with other elements
	filteredList = append(filteredList, timersData[len(timersData)-1])

	// Compare elements
	for i := (len(timersData) - 1); i >= 0; i-- {

		if (filteredList[len(filteredList)-1] - timersData[i]) >= timeDelta {
			filteredList = append(filteredList, timersData[i])
		}

	}

	return filteredList
}

func main() {
	// timersData := []int{1515002100, 1515002110, 1515002120, 1515002130, 1515002120, 1515002130, 1515002130, 1515002130, 1515002110, 1515002120, 1515002130, 1515002100, 1515002110, 1515002120, 1515002130,1515002120, 1515002130, 1515002130, 1515002130, 1515002120, 1515002130, 1515002110, 1515002120, 1515002130, 1515002110, 1515002120, 1515002130, 1515002130, 1515002130, 1515002120, 1515002130, 1515002100, 1515002110, 1515002120, 1515002130, 1515002120, 1515002130, 1515002110, 1515002120, 1515002130, 1515002130, 1515002130, 1515002120, 1515002130, 1515002130, 1515002120, 1515002130, 1515002100, 1515002110, 1515002120, 1515002130, 1515002130, 1515002130, 1515002130, 1515002130, 1515002120, 1515002130, 1515002080, 1515002090, 1515002100, 1515002110, 1515002120, 1515002130, 1515002120, 1515002130, 1515002130, 1515002110, 1515002120, 1515002130, 1515002080, 1515002090, 1515002100, 1515002110, 1515002120, 1515002130}
	// timersData := []int{1515464470, 1515464470, 1515464470, 1515464470, 1515439190, 1515439190, 1515439190, 1515439190, 1515439190, 1515439190, 1515464470, 1515464470, 1515439190, 1515439190, 1515464470, 1515464470, 1515439190, 1515464470, 1515464470, 1515464520, 1515439200, 1515439200, 1515464520, 1515439200, 1515464520, 1515464520, 1515439200, 1515439200, 1515464520, 1515464470, 1515464470, 1515464470, 1515464470, 1515464470}
	// timersData := []int{1515143640, 1515143640}
	timersData := []int64{1515513420, 1515513410, 1515464520, 1515464470, 1515439200, 1515439190, 1515384240, 1515336660, 1515336640, 1515315600, 1515315570, 1515275400, 1515275370, 1515267960, 1515267920, 1515249900, 1515249860}

	for _, p := range filterTime(timersData) {
		fmt.Println(time.Unix(p, 0))
	}

}
